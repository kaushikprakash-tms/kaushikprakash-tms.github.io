<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Embedded Total Mortgage Application</title>
    <script>
      window.onload = function () {
        if (document.getElementsByClassName("tm-component")) {
          window.addEventListener("message", (event) => {
            if (Object.keys(event.data).length > 0) {
              console.log(event.data);
              if (event.data.event_type) {
                switch (event.data.event_type) {
                  case "resize":
                    resizeIframe(event.data);
                    break;
                  case "button_click":
                    buttonClick(event.data);
                    break;
                }
              }
            }
          });
        }
        const resizeIframe = (data) => {
          var width = data.payload.width ? parseInt(data.payload.width) : null;
          var height = data.payload.height
            ? parseInt(data.payload.height)
            : null;
          if (width && height && width > 100 && height > 100) {
            document.getElementsByClassName("tm-component")[0].style.width =
              width + "px";
            document.getElementsByClassName("tm-component")[0].style.height =
              height + "px";
          }
        };
        const buttonClick = (body) => {
          alert("Button click fired");
          console.log(body.data);
          if (body.payload.action) {
            switch (body.payload.action) {
              case "APPLY":
                window.location.href =
                  "https://start.totalmortgage.com/purchase?timeTravel=" +
                  body.data;
              // window.open('https://start.totalmortgage.com/purchase?timeTravel='+body.data);
            }
          }
        };
      };
    </script>
    <style>
      body {
        margin: 0;
        padding: 0;
      }
      .tm-component {
        max-width: 100%;
        width: 100%;
      }
      iframe {
        width: 100%;
        height: 100%;
        border: none;
      }
      .flex-item {
        flex: 1;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- Placeholder content -->
      <div class="flex-item">
        <h1>Articles and Blogs</h1>
        <p>
          Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed blandit
          semper ipsum, eu egestas est consectetur a. Aliquam at sapien odio.
          Fusce ac tortor eros. Pellentesque a turpis non justo facilisis
          maximus. Vestibulum at lorem magna. Fusce venenatis mauris mauris, a
          faucibus libero fringilla in. Nulla ac purus tincidunt, pretium est
          eget, mattis orci. Integer accumsan lorem a elit tincidunt malesuada.
        </p>
        <p>
          Morbi semper malesuada tellus eget euismod. Vestibulum sit amet sapien
          ut lacus aliquam congue. Sed malesuada ligula quis enim laoreet
          dictum. Etiam consectetur viverra est, ac malesuada metus bibendum
          vel. Vestibulum non purus eget lectus consectetur ullamcorper ac id
          augue. Integer posuere magna ut mollis pulvinar.
        </p>
      </div>
      <div class="flex-item tm-component">
        <iframe
          src="https://start.totalmortgage.com/apply?utm_medium=embed&ref_email=team@totalmortgage.com"
          allowfullscreen
        ></iframe>
      </div>
      <!-- Placeholder content -->
      <div class="flex-item">
        <h1>Articles and Blogs</h1>
        <p>
          Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed blandit
          semper ipsum, eu egestas est consectetur a. Aliquam at sapien odio.
          Fusce ac tortor eros. Pellentesque a turpis non justo facilisis
          maximus. Vestibulum at lorem magna. Fusce venenatis mauris mauris, a
          faucibus libero fringilla in. Nulla ac purus tincidunt, pretium est
          eget, mattis orci. Integer accumsan lorem a elit tincidunt malesuada.
        </p>
        <p>
          Morbi semper malesuada tellus eget euismod. Vestibulum sit amet sapien
          ut lacus aliquam congue. Sed malesuada ligula quis enim laoreet
          dictum. Etiam consectetur viverra est, ac malesuada metus bibendum
          vel. Vestibulum non purus eget lectus consectetur ullamcorper ac id
          augue. Integer posuere magna ut mollis pulvinar.
        </p>
      </div>
    </div>
  </body>
</html>
